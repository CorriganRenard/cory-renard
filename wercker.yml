box: debian
build:
  steps:
    - script:
        name: install git
        code: |
          apt-get update
          apt-get -y install git
    - script:
        name: download theme
        code: |
          git clone https://github.com/gizak/nofancy.git /pipeline/source/themes
          rm -rf themes/nofancy/.git
    - arjen/hugo-build:
        version: "0.15"
        theme: nofancy

deploy:
  steps:
    - s3sync:
      source_dir: public/
      delete-removed: true
      bucket-url: $AWS_BUCKET_URL
      key-id: $AWS_ACCESS_KEY_ID
      key-secret: $AWS_SECRET_ACCESS_KEY
